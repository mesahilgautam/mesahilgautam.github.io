<!DOCTYPE html>
<html lang="en" style="font-size: 104%">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="author" content="Sahil Gautam">

  
  
  <meta name="description" content="What do I want to achieve It&rsquo;s important to set some target before jumping into and starting to do the thing. I would like to make an annoying &ldquo;Donate Now&rdquo; dialog
The dialog would show up whenever the user starts libreoffice, or whenever he switches to different modules like calc or writer etc.
The dialog would look something like the mockup shown below. The dialog should have a faint background image which shows all the community members, to give out cheerfull vibes.">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://img.icons8.com/clouds/100/india.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://img.icons8.com/clouds/100/india.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://img.icons8.com/clouds/100/india.png">

  
  
  <meta name="keywords" content="hugo latex theme blog texify texify2 weastur">
  

  
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script type="module">
    import renderMathInElement from "https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.mjs";
    renderMathInElement(document.body);
</script>

  

  
  

  
  <meta property="og:title" content="User Hostile Dialog Box" />
<meta property="og:description" content="What do I want to achieve It&rsquo;s important to set some target before jumping into and starting to do the thing. I would like to make an annoying &ldquo;Donate Now&rdquo; dialog
The dialog would show up whenever the user starts libreoffice, or whenever he switches to different modules like calc or writer etc.
The dialog would look something like the mockup shown below. The dialog should have a faint background image which shows all the community members, to give out cheerfull vibes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mesahilgautam.github.io/post/libreoffice-user-hostile-dialog-box/" /><meta property="og:image" content="https://mesahilgautam.github.io/images/logo.jpg"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2024-03-11T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-14T03:58:28+05:30" /><meta property="og:site_name" content="Sahil Gautam" />


  
  <link rel="canonical" href="https://mesahilgautam.github.io/post/libreoffice-user-hostile-dialog-box/">

  
  
  <meta itemprop="name" content="User Hostile Dialog Box">
<meta itemprop="description" content="What do I want to achieve It&rsquo;s important to set some target before jumping into and starting to do the thing. I would like to make an annoying &ldquo;Donate Now&rdquo; dialog
The dialog would show up whenever the user starts libreoffice, or whenever he switches to different modules like calc or writer etc.
The dialog would look something like the mockup shown below. The dialog should have a faint background image which shows all the community members, to give out cheerfull vibes."><meta itemprop="datePublished" content="2024-03-11T00:00:00+00:00" />
<meta itemprop="dateModified" content="2024-03-14T03:58:28+05:30" />
<meta itemprop="wordCount" content="789"><meta itemprop="image" content="https://mesahilgautam.github.io/images/logo.jpg"/>
<meta itemprop="keywords" content="" />

  
  <link media="screen" rel="stylesheet" href='https://mesahilgautam.github.io/css/common.css'>
  <link media="screen" rel="stylesheet" href='https://mesahilgautam.github.io/css/content.css'>

  
  
  <title>User Hostile Dialog Box - Sahil Gautam</title>
  

  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://mesahilgautam.github.io/images/logo.jpg"/>

<meta name="twitter:title" content="User Hostile Dialog Box"/>
<meta name="twitter:description" content="What do I want to achieve It&rsquo;s important to set some target before jumping into and starting to do the thing. I would like to make an annoying &ldquo;Donate Now&rdquo; dialog
The dialog would show up whenever the user starts libreoffice, or whenever he switches to different modules like calc or writer etc.
The dialog would look something like the mockup shown below. The dialog should have a faint background image which shows all the community members, to give out cheerfull vibes."/>


  
<link rel="stylesheet" href='https://mesahilgautam.github.io/css/single.css'>
<link rel="stylesheet" href='https://mesahilgautam.github.io/css/sharingbuttons.css'>

</head>

<body>
  <div id="wrapper">
    


<header id="header">
  <h1>
    <a href="https://mesahilgautam.github.io/">Sahil Gautam</a>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      <a class="link" href="/">Home</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/post/">Archive</a>
    </span>
    
  </nav>
  
</header>

    
<main id="main" class="post">
  
  <h1>User Hostile Dialog Box</h1>
  
  
  
  
    <br>
    <summary>
      <b>Table of Contents</b>
    </summary>

    <nav>
    <div class="toc numbered-subtitles"><nav id="TableOfContents">
  <ul>
    <li><a href="#what-do-i-want-to-achieve">What do I want to achieve</a></li>
    <li><a href="#starting-with-the-ui">Starting with the UI</a>
      <ul>
        <li><a href="#creating-a-dialog">Creating a Dialog</a></li>
        <li><a href="#what-next">What Next?</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
    </nav>
  
  
  
  <article class="content numbered-subtitles">
    
    <p><a href="https://sahilgautam.in" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://www.svgrepo.com/show/130741/blog.svg" /> </a>
<a href="https://twitter.com/mesahilgautam" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Logo_of_Twitter.svg/2491px-Logo_of_Twitter.svg.png" /> </a>
<a href="https://www.linkedin.com/in/mesahilgautam" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/LinkedIn_icon.svg/768px-LinkedIn_icon.svg.png" /> </a>
<a href="https://github.com/mesahilgautam" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://static-00.iconduck.com/assets.00/github-icon-2048x2048-dpporae2.png" /> </a>
<a href="https://gerrit.libreoffice.org/q/owner:sahil%2540libreoffice.org" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Gerrit_icon.svg/1024px-Gerrit_icon.svg.png" /> </a>
<a href="mailto:me.sahilgautam@gmail.com" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Gmail_icon_%282020%29.svg/2560px-Gmail_icon_%282020%29.svg.png" /> </a>
<br></p>
<h2 id="what-do-i-want-to-achieve">What do I want to achieve</h2>
<p>It&rsquo;s important to set some target before jumping into and starting to do the
thing. I would like to make an annoying &ldquo;Donate Now&rdquo; dialog</p>
<ul>
<li>
<p>The dialog would show up whenever the user starts libreoffice, or whenever he
switches to different modules like calc or writer etc.</p>
</li>
<li>
<p>The dialog would look something like the mockup shown below. The dialog
should have a faint background image which shows all the community members,
to give out cheerfull vibes. Other than that it would have a text which would
be some interesting fact about libreoffice.</p>
</li>
<li>
<p>It would have an image on the top, and a &ldquo;donate now&rdquo; and a &ldquo;close&rdquo; button on
the bottom It would also have a checkbox saying &ldquo;I am broke&rdquo;, which would be
unchecked by default. If the user checks it, then the dialog will stop asking
for monitory donations, and instead pester the user with &ldquo;Other Ways To
Contribute&rdquo;, which would include all the getting involved stuff.</p>
</li>
<li>
<p>Other than that It would also have an &ldquo;I don&rsquo;t care&rdquo; checkbox, which will be
unchecked by default, and if checked, the dialog won&rsquo;t show up again, and
then one has to reactivate it from <code>about &gt; user-hostile-donation-dialog</code>.</p>
</li>
</ul>
<img align="center" alt="Git" width="400px" style="padding-right:10px;" src="/attachments/202411074_6.png" />
<p>This would makeup for a nice and fun learning experience. It would involve
playing around with the UI, listeners, strings, &ldquo;the user centiments&rdquo; etc.</p>
<p>It&rsquo;s not a rigid outline, but rather an idea to atleast get started.</p>
<h2 id="starting-with-the-ui">Starting with the UI</h2>
<p>I will start with understanding how the about dialog is implemented, how does
it display images and custom text etc. One thing that I noticed previously is that
the &ldquo;Tip Of The Day&rdquo; dialog uses GtkDrawingArea while the about dialog uses GtkImage.</p>
<blockquote>
<p>I asked on the #gtk IRC channel, and found that GtkImage is an image loaded from the
disk at a specific size, while GtkDrawingArea is a canvas you draw on using cario.</p>
</blockquote>
<p>This might have been the reason for why Libreoffice was carshing when I used GtkImage
while trying to recreate the &ldquo;Tip Of The Day&rdquo; dialog. There I just created a bare
constructor, without specifying the image.</p>
<p>Well for the user hostile dialog, GtkImage would work fine as I don&rsquo;t need to change the
image on the go.</p>
<h3 id="creating-a-dialog">Creating a Dialog</h3>
<p>I created a dialog box using glade. The challenge that I faced was that I was
not able to move the checkboxes in the ButtonBox of the GtkDialog to the left
side. All 4 controls were stuck together. Then I looked into how the
tip-of-the-day dialog does it, and there I found that whatever control I wanted
to left align (in the button box), I had to turn on the <code>packing &gt; secondary</code>
control. What that is, I am still to investigate into.I got this <a href="https://docs.gtk.org/gtk3/method.ButtonBox.set_child_secondary.html">Documentation Reference</a>
from the #gtk IRC channel.</p>
<p>For some reason, the dialog doesn&rsquo;t carsh now :). Other issue that I faced was
related to text wrapping. So if I set some long text in a <code>weld::Label</code> using
the <code>set_label(OUString)</code> function, then it just expands the dialog to fit in
one line. GtkImage is just a bitmap image, for which we specify the size
(width) while loading it. For label wrapping, I will look into how the
tip-of-the-day dialog does it. Making the dialog resizable doesn&rsquo;t work as
well. Under <code>general &gt; formatting</code> of the GtkLabel there is an option to specify
wrapping properties, and just below that are boxes for max width. Playing around with
those, I was able to get text wrapping to work.</p>
<blockquote>
<p>Sometimes these things feel hard, and I tend to avoid them as much as I can.
But Now I realize that it is those hard moments which build me to tackel bigger
challenges, and I should be looking for such opportunities. Today I find glade
easier to use compared to yesterday</p>
</blockquote>
<p>I got the dialog as I wanted. Looks nice! When I was working on the dialog, I
changed the <code>SID_ABOUT:</code> unocommand to display the user-hostile-dialog instead
of the about dialog. This way I was able to test whether it works as expected
or not.</p>
<img align="center" alt="Git" width="350px" style="padding-right:10px;" src="/attachments/2024-075.png" />
<p>Then I went ahead to work on the listeners and the configuration logic. There
should be some way for us to remember what options were checked/unchecked when
the dialog was closed (configuration), and some way know which module we are
entering, so that we can change the text accordingly (listeners).</p>
<h3 id="what-next">What Next?</h3>
<p>I figured that for each dialog, we have a generic wrapper class called
<code>VclAbstractDialog</code>. It provides &ldquo;one type for all dialogs&rdquo; solution, which
makes sense. I followed the about/tip-of-the-day dialog to write all these
functions and classes. And since I want a menu entry as well, I had to create
an unocommand as well.</p>

    
  </article>
  

<div id="sharingbuttons">
    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    
</div>

  <div class="paginator">
    
    <a></a>
    
    
    <a class="link" href="https://mesahilgautam.github.io/post/computer-graphics-from-scratch/">next →</a>
    
  </div>
  <div class="comment">
    
    
    
    
  </div>
  

</main>

    <footer id="footer">
  <div>
    <span>© 2024</span> - <span>2024</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" target="_blank" href="https://gohugo.io/">Hugo</a>
    <span> 🍦 Theme </span>
    <a class="link" target="_blank" href="https://texify2.io">TeXify2</a>
  </div>

  <div class="footnote">
    <span></span>
  </div>
</footer>

  </div>

  
  

  
  

  
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0GZRVRLSQV"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-0GZRVRLSQV', { 'anonymize_ip': false });
}
</script>


</body>

</html>
