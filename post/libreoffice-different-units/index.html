<!DOCTYPE html>
<html lang="en" style="font-size: 104%">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="author" content="Sahil Gautam">

  
  
  <meta name="description" content="Why work on this Working on this involves understanding the controlls, specially the spinedit, finding some way to modify it so that clicking on the units &ldquo;the last 2 characters of the label in the spinedit entry&rdquo; shows a dropdown, from which we can select a different unit.
I find working on this as a great opportunity to get deeper insights into widget implementations
Finding a Starting Point I had no idea about where to start.">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="https://img.icons8.com/clouds/100/india.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://img.icons8.com/clouds/100/india.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://img.icons8.com/clouds/100/india.png">

  
  
  <meta name="keywords" content="hugo latex theme blog texify texify2 weastur">
  

  
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<script type="module">
    import renderMathInElement from "https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.mjs";
    renderMathInElement(document.body);
</script>

  

  
  

  
  <meta property="og:title" content="Different Units of Measurement in Libreoffice" />
<meta property="og:description" content="Why work on this Working on this involves understanding the controlls, specially the spinedit, finding some way to modify it so that clicking on the units &ldquo;the last 2 characters of the label in the spinedit entry&rdquo; shows a dropdown, from which we can select a different unit.
I find working on this as a great opportunity to get deeper insights into widget implementations
Finding a Starting Point I had no idea about where to start." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mesahilgautam.github.io/post/libreoffice-different-units/" /><meta property="og:image" content="https://mesahilgautam.github.io/images/logo.jpg"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2024-03-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-15T20:35:03+05:30" /><meta property="og:site_name" content="Sahil Gautam" />


  
  <link rel="canonical" href="https://mesahilgautam.github.io/post/libreoffice-different-units/">

  
  
  <meta itemprop="name" content="Different Units of Measurement in Libreoffice">
<meta itemprop="description" content="Why work on this Working on this involves understanding the controlls, specially the spinedit, finding some way to modify it so that clicking on the units &ldquo;the last 2 characters of the label in the spinedit entry&rdquo; shows a dropdown, from which we can select a different unit.
I find working on this as a great opportunity to get deeper insights into widget implementations
Finding a Starting Point I had no idea about where to start."><meta itemprop="datePublished" content="2024-03-15T00:00:00+00:00" />
<meta itemprop="dateModified" content="2024-03-15T20:35:03+05:30" />
<meta itemprop="wordCount" content="492"><meta itemprop="image" content="https://mesahilgautam.github.io/images/logo.jpg"/>
<meta itemprop="keywords" content="" />

  
  <link media="screen" rel="stylesheet" href='https://mesahilgautam.github.io/css/common.css'>
  <link media="screen" rel="stylesheet" href='https://mesahilgautam.github.io/css/content.css'>

  
  
  <title>Different Units of Measurement in Libreoffice - Sahil Gautam</title>
  

  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://mesahilgautam.github.io/images/logo.jpg"/>

<meta name="twitter:title" content="Different Units of Measurement in Libreoffice"/>
<meta name="twitter:description" content="Why work on this Working on this involves understanding the controlls, specially the spinedit, finding some way to modify it so that clicking on the units &ldquo;the last 2 characters of the label in the spinedit entry&rdquo; shows a dropdown, from which we can select a different unit.
I find working on this as a great opportunity to get deeper insights into widget implementations
Finding a Starting Point I had no idea about where to start."/>


  
<link rel="stylesheet" href='https://mesahilgautam.github.io/css/single.css'>
<link rel="stylesheet" href='https://mesahilgautam.github.io/css/sharingbuttons.css'>

</head>

<body>
  <div id="wrapper">
    


<header id="header">
  <h1>
    <a href="https://mesahilgautam.github.io/">Sahil Gautam</a>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      <a class="link" href="/">Home</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/post/">Archive</a>
    </span>
    
  </nav>
  
</header>

    
<main id="main" class="post">
  
  <h1>Different Units of Measurement in Libreoffice</h1>
  
  
  
  
    <br>
    <summary>
      <b>Table of Contents</b>
    </summary>

    <nav>
    <div class="toc numbered-subtitles"><nav id="TableOfContents">
  <ul>
    <li><a href="#why-work-on-this">Why work on this</a></li>
    <li><a href="#finding-a-starting-point">Finding a Starting Point</a></li>
    <li><a href="#starting-the-hunt">Starting the Hunt</a></li>
  </ul>
</nav></div>
    </nav>
  
  
  
  <article class="content numbered-subtitles">
    
    <p><a href="https://sahilgautam.in" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://www.svgrepo.com/show/130741/blog.svg" /> </a>
<a href="https://twitter.com/mesahilgautam" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Logo_of_Twitter.svg/2491px-Logo_of_Twitter.svg.png" /> </a>
<a href="https://www.linkedin.com/in/mesahilgautam" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/LinkedIn_icon.svg/768px-LinkedIn_icon.svg.png" /> </a>
<a href="https://github.com/mesahilgautam" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://static-00.iconduck.com/assets.00/github-icon-2048x2048-dpporae2.png" /> </a>
<a href="https://gerrit.libreoffice.org/q/owner:sahil%2540libreoffice.org" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Gerrit_icon.svg/1024px-Gerrit_icon.svg.png" /> </a>
<a href="mailto:me.sahilgautam@gmail.com" ><img align="left" alt="Git" width="30px" style="padding-right:10px;" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Gmail_icon_%282020%29.svg/2560px-Gmail_icon_%282020%29.svg.png" /> </a>
<br></p>
<h2 id="why-work-on-this">Why work on this</h2>
<p>Working on this involves understanding the controlls, specially the spinedit,
finding some way to modify it so that clicking on the units &ldquo;the last 2
characters of the label in the spinedit entry&rdquo; shows a dropdown, from which we
can select a different unit.</p>
<img align="center" alt="Mockup" width="60%" style="padding-right:10px;" src="https://bug-attachments.documentfoundation.org/attachment.cgi?id=130628" />
<p>I find working on this as a great opportunity to get deeper insights into
widget implementations</p>
<h2 id="finding-a-starting-point">Finding a Starting Point</h2>
<p>I had no idea about where to start. One approach that appealed to me was if somehow
I find the cursor position when the spinedit goes into edit mode, and compare it to
the text length in the GtkEntry (internal) of the spinedit, then I can easily say that
if the cursor is on the last 2 characters, then show a dropdown here. But that would
not work, because &ldquo;creating a new widget&rdquo; ==&gt; the logic should be built into the
widget itself (I don&rsquo;t know, it&rsquo;s just guess-work).</p>
<p>Then I went to #gtk IRC channel, and asked about how to approach this problem.</p>
<table>
<thead>
<tr>
<th>IRC Conversation</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>sahil_</strong></td>
<td>hi, I have a task to write a custom spinedit control, which will have a fontsize field (with a number and a unit like mm, pt, etc). It should be such that if I click on the unit with mouse, then it should show me a dropdown to use different units. <a href="https://bug-attachments.documentfoundation.org/attachment.cgi?id=130628">Mockup</a> Here&rsquo;s the mockup. How can I approach it?</td>
</tr>
<tr>
<td><strong>sahil_</strong></td>
<td>Libreoffice uses glade and custom welding for widgets. And from the research I did on it, I found that a normal gtkentry is aware of the cursor position, which can be used like if the cursor is on the last 2 characters, then show the popup.</td>
</tr>
<tr>
<td><strong>sahil_</strong></td>
<td>But a new control has to be created for that (in my understanding).</td>
</tr>
<tr>
<td><strong>mclasen</strong></td>
<td>The pieces are <code>GtkText</code> and <code>GtkGestureClick</code>. You just have to glue them together in the right way</td>
</tr>
<tr>
<td><strong>sahil_</strong></td>
<td><strong>mclasen</strong>: and for the dropdown?</td>
</tr>
<tr>
<td><strong>mclasen</strong></td>
<td>GtkPopover is what is used for that</td>
</tr>
<tr>
<td><strong>sahil_</strong></td>
<td>Also the spinedit doesn&rsquo;t expose the gtkEntry (it&rsquo;s internal). So do I have to create one from scratch?</td>
</tr>
<tr>
<td><strong>sahil_</strong></td>
<td>or does it?</td>
</tr>
<tr>
<td><strong>mclasen</strong></td>
<td>you can take a look at how GtkEntry, GtkSpinButton, etc are put together nowadays  they are all just wrappers around a GtkText widget</td>
</tr>
</tbody>
</table>
<p>This was more than enough to get started.</p>
<h2 id="starting-the-hunt">Starting the Hunt</h2>
<p>Looking into it, I found that I was mixing up GtkComboBox, which is used as
fontsizebox, and GtkSpinButton, which is what I was supposed to explore and
modify. <code>weld::SpinButton</code>, which is libreoffice&rsquo;s wrapper over <code>GtkSpinButton</code>
(if I am not wrong) has functions which give access to the cursor location in
the Entry. It would require some playing around to understand the dynamics
though.</p>
<blockquote>
<p>I am also curious about how a dialog, or any UI element, which is created
using glade, which usually has the widgets as Gtk types (GtkLabel, GtkButton
etc.) is loaded into different backends. Knowing how the welding works would answer
it I think.</p>
</blockquote>

    
  </article>
  

<div id="sharingbuttons">
    
    

    
    

    
    

    
    

    
    

    
    

    
    

    
    
</div>

  <div class="paginator">
    
    <a class="link" href="https://mesahilgautam.github.io/post/libreoffice-user-hostile-dialog-box/">← prev</a>
    
    
    <a></a>
    
  </div>
  <div class="comment">
    
    
    
    
  </div>
  

</main>

    <footer id="footer">
  <div>
    <span>© 2024</span> - <span>2024</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" target="_blank" href="https://gohugo.io/">Hugo</a>
    <span> 🍦 Theme </span>
    <a class="link" target="_blank" href="https://texify2.io">TeXify2</a>
  </div>

  <div class="footnote">
    <span></span>
  </div>
</footer>

  </div>

  
  

  
  

  
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0GZRVRLSQV"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-0GZRVRLSQV', { 'anonymize_ip': false });
}
</script>


</body>

</html>
